<Window x:Class="MedRecordsWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Patient Visit Management" Height="700" Width="900">

	<ScrollViewer VerticalScrollBarVisibility="Auto">
		<StackPanel Background="#f5f5f5" Margin="10">


			<!-- Login Expander -->
			<Expander x:Name="LoginExpander"
				      Header="Login to Medical Records System (Click to Collapse/Expand)"
                      Background="#f0f0f0"
                      Padding="5"
                      Margin="0,0,0,10">
				<StackPanel Background="White" Margin="10">
					<!-- API Connection -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,15">
						<Label Content="API URL:" VerticalAlignment="Center" Width="80"/>
						<TextBox x:Name="TxtApiUrl" Text="https://localhost:7287/swagger" Width="250" Margin="5,0,10,0"/>
						<Button x:Name="TestConnectionButton" Content="Test Connection" Click="TestConnectionButton_Click" Padding="5"/>
					</StackPanel>

					<!-- Login Form -->
					<Label Content="Username:"/>
					<TextBox x:Name="TxtUsername" Margin="0,0,0,5"/>
					<Label Content="Password:"/>
					<PasswordBox x:Name="TxtPassword" Margin="0,0,0,15"/>

					<Button x:Name="LoginButton" Content="Login" Width="100" Height="35"
                            FontWeight="Bold" Background="#0078D4" Foreground="White"
                            Click="LoginButton_Click"/>

					<TextBlock x:Name="StatusText" Margin="0,15,0,0" Foreground="Gray" FontStyle="Italic"/>
				</StackPanel>
			</Expander>
			
			
			<!-- Top: Collapsible Visit History -->
			<Expander Header="Previous Visits History (Click to Collapse/Expand)"
                      Background="#f0f0f0"
                      Padding="5"
                      Margin="0,0,0,10">
				<ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="200">
					<TextBlock x:Name="HistoryTextBlock"
                               TextWrapping="Wrap"
                               Padding="10"
                               FontSize="14"
                               Text="[Patient Visit History will appear here]"/>
				</ScrollViewer>
			</Expander>

			<!-- Registration Expander -->
			<Expander Header="Register New Patient (Click to Collapse/Expand)"
                      Background="#f0f0f0"
                      Padding="5"
                      Margin="0,0,0,10" IsExpanded="True">
				<ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
					<StackPanel Background="White" Margin="10">
						<!-- Patient Registration Form -->
						<Label Content="Patient Name:"/>
						<TextBox x:Name="TxtPatientName" Margin="0,0,0,5"/>

						<Label Content="Date of Birth:"/>
						<DatePicker x:Name="DatePatientBirth" Margin="0,0,0,5"/>

						<Label Content="Gender:"/>
						<ComboBox x:Name="CmbPatientGender" Margin="0,0,0,5" SelectedIndex="0">
							<ComboBoxItem>Male</ComboBoxItem>
							<ComboBoxItem>Female</ComboBoxItem>
						</ComboBox>

						<Label Content="Marital Status:"/>
						<ComboBox x:Name="CmbPatientMaritalStatus" Margin="0,0,0,5" SelectedIndex="0">
							<ComboBoxItem>Single</ComboBoxItem>
							<ComboBoxItem>Married</ComboBoxItem>
							<ComboBoxItem>Divorced</ComboBoxItem>
							<ComboBoxItem>Widowed</ComboBoxItem>
						</ComboBox>

						<Label Content="Contact Number:"/>
						<TextBox x:Name="TxtPatientContact" Margin="0,0,0,5"/>

						<Label Content="Email:"/>
						<TextBox x:Name="TxtPatientEmail" Margin="0,0,0,5"/>

						<Label Content="Address:"/>
						<TextBox x:Name="TxtPatientAddress" Height="60" TextWrapping="Wrap" Margin="0,0,0,15"/>

						<Label Content="Blood Group:"/>
						<TextBox x:Name="TxtBloodGroup" Height="60" TextWrapping="Wrap" Margin="0,0,0,15"/>

						<Label Content="Allergies:"/>
						<TextBox x:Name="TxtAllergies" Height="60" TextWrapping="Wrap" Margin="0,0,0,15"/>

						<StackPanel Orientation="Horizontal" Margin="0,10,0,0" HorizontalAlignment="Left">
							<Button x:Name="RegisterPatientButton" Content="Register Patient" Width="150" Height="35"
									FontWeight="Bold" Background="#28a745" Foreground="White"
									Click="RegisterPatientButton_Click"
									Margin="0,0,10,0"/>
							<Button x:Name="CancelRegisterButton" Content="Cancel" Width="100" Height="35"
									FontWeight="Bold" Background="#dc3545" Foreground="White"
									Click="CancelRegisterButton_Click"/>
						</StackPanel>

						<TextBlock x:Name="RegisterStatusText" Margin="0,10,0,0" Foreground="Gray" FontStyle="Italic"/>
					</StackPanel>
				</ScrollViewer>
			</Expander>

			<!-- Main Content (Patient Management) -->
			<Border x:Name="MainContentSection"
                    Background="White"
                    BorderBrush="#e0e0e0"
                    BorderThickness="1"
                    Padding="15"
                    Margin="0,0,0,10">
				<StackPanel>
					<TextBlock Text="Patient Management" FontWeight="Bold" FontSize="16" Margin="0,0,0,15"/>

					<!-- Patient Search -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,10">
						<TextBox x:Name="TxtPatientSearch" Width="200" Margin="0,0,10,0"
                                 TextChanged="TxtPatientSearch_TextChanged"/>
						<Button Content="Search" Padding="10,5"/>
					</StackPanel>

					<!-- Patient List -->
					<Label Content="Select Patient:"/>
					<ListBox x:Name="PatientListBox" Height="200" Margin="0,0,0,10"
                             SelectionChanged="PatientListBox_SelectionChanged">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding DisplayName}" FontSize="14" Padding="5"/>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>

					<!-- Patient Actions -->
					<StackPanel Orientation="Horizontal" Margin="0,0,0,10">
						<Button Content="Refresh" Padding="10,5" Margin="0,0,10,0"
                                Click="RefreshPatientsButton_Click"/>
						<Button x:Name="AddNewPatientButton" Content="+ Add New Patient" Padding="10,5"
                                Background="#28a745" Foreground="White" Click="AddNewPatientButton_Click"/>
					</StackPanel>

					<!-- Visit Management Section -->
					<Border Background="#f8f9fa" BorderBrush="#e0e0e0" BorderThickness="1" Padding="15" Margin="0,10,0,0">
						<StackPanel>
							<TextBlock Text="Visit Management" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>

							<!-- Selected Patient Info -->
							<Border Background="White" Padding="10" BorderBrush="#e0e0e0" BorderThickness="1" Margin="0,0,0,10">
								<StackPanel>
									<TextBlock x:Name="SelectedPatientInfo" FontWeight="Bold" FontSize="12"/>
									<TextBlock x:Name="SelectedPatientDetails" FontSize="11" Foreground="Gray"/>
								</StackPanel>
							</Border>

							<!-- Visit Form -->
							<Label Content="Diagnosis:" FontSize="12"/>
							<TextBox x:Name="TxtDiagnosis" Height="60" TextWrapping="Wrap" Margin="0,0,0,5"/>

							<Label Content="Notes:" FontSize="12"/>
							<TextBox x:Name="TxtNotes" Height="80" TextWrapping="Wrap" Margin="0,0,0,5"/>

							<Label Content="Marital Status:" FontSize="12"/>
							<ComboBox x:Name="CmbVisitMaritalStatus" Margin="0,0,0,10" SelectedIndex="0">
								<ComboBoxItem>Single</ComboBoxItem>
								<ComboBoxItem>Married</ComboBoxItem>
								<ComboBoxItem>Divorced</ComboBoxItem>
								<ComboBoxItem>Widowed</ComboBoxItem>
							</ComboBox>

							<Button x:Name="SaveVisitButton" Content="Save Visit" Width="120" Height="35"
                                    FontWeight="Bold" Background="#0078D4" Foreground="White"
                                    Click="SaveVisitButton_Click"/>
						</StackPanel>
					</Border>
				</StackPanel>
			</Border>
		</StackPanel>
	</ScrollViewer>
</Window>